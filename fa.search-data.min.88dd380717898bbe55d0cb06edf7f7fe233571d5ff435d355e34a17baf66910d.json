[{"id":0,"href":"/fa/docs/measure-internet-censorship/","title":"مقدمه ی بررسی سانسور اینترنت","section":"Docs","content":"بررسی سانسور اینترنت #  مقدمه #  امروزه اینترنت بخش مهم زندگی اکثر مردم جهان شده است. و برای بعضی از افراد، همچون هوا، ضروری است. به حدی که به عنوان حقوق اولیه ی هر انسانی به شمار می آید. اما در بعضی کشورها همچون ایران، حقوق مردم در هر سمت مورد تعرض قرار می گیرد. سرویس های مهم خارجی که بخش اصلی منابع مهم دنیا و تکنولوژی ها را در دست دارند، دسترسی ایرانی ها را محدود و یا مسدود کرده اند. سیستم سانسور جمهوری اسلامی هم، همراه با این محدودیت ها عمل کرده و برخی از این سرویس ها را برای مردم محدود و یا مسدود کرده است؛ به طریقی که سرویسی مانند «شکن» هم نمی تواند برای دور زدن این تحریم ها کاری انجام دهد. و یا اینکه سیستم سانسور جمهوری اسلامی، دائما در حال شناسایی و مسدود کردن سرور های پراکسی و VPN است که بخشی مهمی از آن برای دور زدن تحریم ها به کار گرفته می شود. اخیرا سیستم سانسور جمهوری اسلامی عملی انجام داده که به صورت پیشفرض امکان ارتباط HTTPS به سمت خیلی از سرویس های خارجی وجود نداشته باشد. به عبارتی تمام سرویس های خارجی که طبق استاندارد جهانی هستند اما طبق علاقه ی سیستم سانسور جمهوری اسلامی نیستند، محکوم به نابودی شدند. مانند تمام برنامه هایی که با زبان Go نوشته شده و در موبایل به کار گرفته می شوند و یا تمام ارتباطاتی که با ElectronJS نوشته شدند و تمایل به ارتباط با سرور های AWS آمازون و یا گیتهاب دارند. همچنین در بخش هایی نشان داده می شود که چطور سیستم سانسور جمهوری اسلامی به صورت random در ارتباطات اختلال ایجاد می کند. طبق آخرین تحقیقاتی که OONI انجام داده، می توان به یک نتیجه ای رسید که روش کار در بین خیلی از این حکومت های تمامیت خواه یکسان است. به عنوان مثال شیوه ای از اختلال موقتی در سرویس ها در ایران، قزاقستان و اوگاندا یکسان است و تقریبا از یک بازه ی زمانی شروع شده است. در این شرایط بسیار سخت است تا متوجه شویم که ایراداتی که در ارتباطمان وجود دارد، از کجا نشات می گیرند. به همین دلیل تصمیم به نوشتن این مقاله گرفتم.\nتعاریف واژه ها و اصطلاحات #  ابتدا چند تعریف انجام می شود که ممکن است بین همه مشترک نباشد اما در این مقاله از آنها استفاده خواهیم کرد که توضیحات کمتر شوند.\nشخص ناشناس #  به تمام دستگاه ها و افرادی که بین دستگاه شما و سرور نهایی قرار میگیرند، اعم از مسئول شبکه ی ارائه دهنده ی خدمات اینترنت شما، دستگاه های سانسور، هکر یا بدافزار احتمالی در شبکه، سرور پراکسی و یا VPN، مسئول شبکه ی ارائه دهنده ی خدمات اینترنت سرور، را شخص ناشناس می گوییم. این شخص میتواند فقط نظارت داشته باشد و یا در شبکه و packet ها دستکاری انجام دهد و یا اطلاعاتی را سرقت کند.\n  (با کمی تغییرات از طرح اصلی سازمان EFF)\nسیاهچاله #   null route یا black hole route روشی است که packet ها توسط سیستم سانسور دور ریخته می شوند و به طریقی که درخواست کلاینت و یا درخواست سرور به یکدیگر نمی رسد را سیاه چاله می گوییم. در این حالت ارتباط در حالت بلاتکلیفی می ماند و سیستم عامل کلاینت و یا سرور و یا هر دو، مدام retransmission انجام می دهند اما جوابی دریافت نمی کنند.\n  (طراحی شده با draw.io)\nبه جای این کار سیستم سانسور می تواند packet ای با Flag ای شامل RST ارسال کند و یا RST را در packet ای که از سمت سرور ارسال می شود تزریق کند اما این کار را نمی کند. این روش دو سود برای سیستم سانسور دارد: اول اینکه زمان بیشتری از کاربران اینترنت هدر می دهد و کاربران را بیشتر منتظر می گذارد. دوم اینکه این سانسور بالاتر از سطح ISP انجام می شود و این retransmission ها که معمولا packet ای با حجم قابل توجه ای هستند، در تعداد زیاد و مداوم، برای ISP ها سودآور خواهند بود. هر دو از نظر اخلاقی، همانند وضع سانسور فعلی، درست نیستند، اما متاسفانه واقعیت دارند.\nسیستم سانسور جمهوری اسلامی #  سیستم سانسورِ حاضر در اینترنت ایران، به نام سیستم سانسور جمهوری اسلامی بیان شده. به دلیل اینکه تمام مردم ایران برای رد شدن از آن هزینه می کنند، اما تمام سازمان های وابسته به جمهوری اسلامی در توسعه و تداوم آن مشارکت دارند. در نتیجه این سیستم سانسور «ایران» نیست و حتی «برای مردم ایران» نیست بلکه «بر ضد مردم ایران» است. حتی طبق داده های یکی از VPN های معروف که به صورت جهانی سرویس ارائه می دهد، حدود 400 هزار نفر روزه داران ایرانی که امسال (1400) برای سحر بیدار می شدند و از این VPN استفاده می کردند، بعد از وصل شدن به اینترنت، این VPN را نیز فعال می کردند.\n   با توجه به این مسئله که این آمار فقط مربوط به یک VPN از بسیار فیلترشکن موجود است، به وضوح نشان می دهد که اکثریت مردم مذهبی و غیرمذهبی ایران، با سانسور اینترنت مخالف هستند. نکات #  \nاکثر دستورات در لینوکس استفاده شدند. اما معادل هایی برای ویندوز نیز در صورت وجود معرفی شده است.\n\nتوجه: اگر در شبکه های اجتماعی به صورت ناشناس فعالیت می کنید، نتیجه ی بعضی از این آزمایشات ممکن است موجب افشا شدن هویت واقعی شما شود. همچنین در سانسور مشخصات یکتای خود کوشا باشید. امنیت سایبری شما و اطرافیانتان به آنها بستگی دارد.\n"},{"id":1,"href":"/fa/docs/measure-internet-censorship/OONI/","title":"بررسی سانسور اینترنت از طریق کاوشگر OONI","section":"مقدمه ی بررسی سانسور اینترنت","content":"بررسی سانسور اینترنت از طریق کاوشگر OONI #     OONI و یا Open Observatory of Network Interference، ترجمه شده به فارسی: «رصد خانه آزاد دخالت در شبکه»، یک پروژه ی نرم افزاری متن باز و آزاد با هدف توانمند سازی تلاش های غیرمتمرکز در افزایش شفافیت سانسور اینترنت در سراسر جهان است. OONI یک سَمَن یا سازمان غیردولتی است که توسط پروژه ی Tor راه اندازی شد و اکنون به صورت نیمه مستقل فعالیت می کند. این پروژه با ایجاد نرم افزارهایی برای سیستم عامل های مختلف این امکان را فراهم می کند که یک شخص بدون نیاز به دانش فنی، فقط با اجرا کردن تست ها، شواهدی معتبر از سانسور تهیه کند.\n  \n  به صورت پیشفرض این اطلاعات با حفظ حریم خصوصی کاربران، برای سرور OONI ارسال می شوند. اطلاعات دریافتی در سرور دوباره پردازش می شوند و در اکثر مواقع در کمتر از یک دقیقه در بخشی به نام Explorer تحت وب در دسترس همگان خواهد بود.\n   از سال 2012 تاکنون از بیش از 200 کشور نتایج اندازه گیری دریافت کرده.\nچگونگی کارکرد تست Websites #  در Probe های OONI بخشی به نام Websites وجود دارد که در حال حاضر می تواند آدرس های http:// و https:// را مورد آزمایش قرار دهد. این تست که با اسم Web connectivity شناخته می شود به این صورت کار می کند که ابتدا یک بار آدرس درخواستی را از طریق backend خود مورد آزمایش قرار می دهد تا از فعال بودن آن اطمینان حاصل کند و همچنین جواب DNS و محتوای دریافتی در backend را با DNS و محتوای دریافتی در شبکه ی مورد تست مقایسه کند. به این معنی که اگر پاسخ تست ای، Anomaly و یا Confirmed بوده است، تست در backend و خارج از شبکه در همان لحظه با موفقیت انجام شده است. این مسئله صحت نتیجه در مورد وجود سانسور را تضمین می کند.\nبه صورت پیشفرض این تست از لیست آدرس هایی استفاده می کند که توسط CitizenLab ساخته شده و هر کسی میتواند در بهبود آن مشارکت داشته باشد. در هر کشور دو لیست مورد استفاده قرار میگیرد که یک لیست اختصاصی آن کشور و یک لیست جهانی است. در زمان نوشتن این مقاله این دو لیست شامل 2242 آدرس است. باید توجه داشته باشید که این لیست سایت هایی نیست که احتمال سانسور شدن آنها زیاد است. می توان گفت که این لیست ای از سرویس های پر استفاده است. اما نه لیست ای که توسط سرویس هایی مانند Alexa معرفی می شود، چون در بسیاری از کشور ها، مردم از ابزار های حفظ حریم خصوصی همانند VPN ها استفاده می کنند و یا در کشورهایی مثل ایران، اکثر سرویس های پراستفاده ی مردم، مسدود یا تحریم هستند و کاربر نمی تواند به صورت مستقیم به آنها دسترسی پیدا کند. تست های پیشفرض در این بخش، به صورت پیشفرض فقط 90 ثانیه اجرا می شوند که از بخش تنظیمات این مقدار قابل تغییر است. مقدار 0 برابر با انجام اندازه گیری تمام آدرس های لیست پیشفرض است.\nالبته این امکان وجود دارد تا آدرس ها و یا آدرس های سفارشی خودتان را نیز بدون نیاز به ثبت در لیست پیشفرض در شبکه ی خود و یا دوستانتان تست کنید. برای این کار دو روش وجود دارد:\n وارد کردن مستقیم لیست در اپ ها ایجاد لیست تست سفارشی  وارد کردن مستقیم آدرس های سفارشی در نرم افزار #  برای انجام این کار به صورت درون برنامه ای، وارد بخش Websites شوید و بر روی دکمه ی Choose websites و یا «انتخاب وبسایت ها» کلیک کنید :\n  \n  آدرس های مورد نظر خود را وارد کنید. و در انتها دکمه ی Run در پایین صفحه را بزنید.   \n  و در انتها بر روی دکمه ی Run و یا اجرا کلیک کنید تا اندازه گیری آغاز شود.\nدر نسخه ی cli، به این صورت می توان انجام داد: اگر تابحال اجرا نکردید، کی بار مراحل و شرایط استفاده را بخوانید و در صورت موافقت تایید کنید:\n .\\ooniprobe.exe سپس لیست انتخابی خود را به این صورت اجرا کنید: .\\ooniprobe.exe run websites \u0026ndash;input=https://yahoo.com/ \u0026ndash;input=https://yimg.com/\n    در این حالت نتیجه ی هر تست و تفاوت ها به صورت لحظه ای نشان داده می شود.\nایجاد لیست تست سفارشی #  برای اینکه یک لیست سفارشی داشته باشید که بتوانید با دیگران به اشتراک بگذارید، می توانید به این آدرس رجوع کرده: https://run.ooni.io/\n   بعد از اضافه کردن آدرس های دلخواه از طریق دکمه ی Add URL دکمه ی Generate را بزنید.\n   آدرس داده شده را کپی کرده و از طریق شبکه های اجتماعی برای دیگران بفرستید.\n   کاربران در موبایل می توانند فقط با زدن بر روی لینک، اپ OONI Probe را انتخاب کرده:\n   و با زدن دکمه ی Run اندازه گیری را شروع کنند.\n   آنالیز نتایج #  آنالیز نتایج OONI بسیار ساده و آسان است. شما نیاز به داشتن دانش فنی برای درک وجود سانسور یا نبود آن ندارید. به عنوان مثال در این تصویر:\n   از 7 مورد آزمایش شده، دو مورد را با اطمینان می توان گفت که ارتباطشان به دلیلی در آن لحظه مسدود شده است و چهار مورد در دسترس بودند.\nهمچنین یک مورد با رنگ خاکستری است که سه دلیل شایع می تواند داشته باشد: غیرفعال بودن سایت اصلی قطع شدن لحظه ای ارتباط در زمان انجام آن تست وجود باگ یا ناتوانی در تحلیل.\nتوضیحات آن نیز به این صورت است که علاوه بر مشاهده ی توضیحات بیشتر می توانید با زدن بر روی دکمه ی Try Again، دوباره اقدام به تست آن یک آدرس کنید:\n   آنالیز ساده ی نتایج #  برای بررسی دقیقتر، در توضیحات هر نتیجه، دلیل آنها بیان شده است. چند مورد را که ممکن است بیشتر با آنها مواجه شوید در ادامه توضیح داده خواهد شد.\nHTTP blocking (a blockpage might be served) #     در این تست احتمال می رود که ممکن است صفحه ی مربوط به سانسور به جای صفحه ی اصلی دریافت شده است. این اتفاق فقط در ارتباط های غیر رمزنگاری شده و مخصوصا HTTP ممکن است. در این حالت چهار دلیل ممکن است: دریافت خطای 503، که خود نوعی سانسور است (در بخشی های بعدی توضیح داده خواهد شد) حساسیت به آدرس سایت در بخش Host ارتباط HTTP حساسیت به Request URI یا همان ادامه ی آدرس بعد از Hostname. (در این تست فقط / هست.) حساسیت به یک کلمه در آن سایت.\nDNS tampering #     در این تست احتمال می رود که یک IP ی جعلی دریافت شده است. در این حالت، از DNS مسدود شده است.\nTCP/IP based blocking #     در این تست عمل TCP Handshake انجام نشده. که ممکن است به دلیل وارد سیاهچاله شدن ارتباط باشد و یا ارسال packet های RST. در این حالت IP مسدود شده است.\nHTTP blocking (HTTP requests failed) #     در این تست TCP Hnadshake انجام شده است (IP مسدود نیست) اما بعد از آن ناموفق بوده است. این خطا ممکن است در هر دو ارتباط HTTP و HTTPS مشاهده شود.\nآنالیز پیشرفته ی نتایج #  برای آنالیز پیشرفته تر، در نرم افزار های OONI این امکان وجود دارد تا دیتای جمع آوری شده از هر تست را ببینید.\n   این دیتا از طریق آدرس اختصاصی Explorer نیز در دسترس است.\n   در این دیتا، اطلاعات کلی و جزئی هر اندازه گیری به صورت مجزا وجود دارد.\nتوضیح بعضی از بخش ها:\nprobe_ip #  مقدار probe_ip که برابر با IP کاربر است. برای حفظ حریم خصوصی، به صورت پیشفرض در سمت کلاینت به 127.0.0.1 تغییر داده می شود.\nresolver_ip #  مقدار resolver_ip برابر IP سرور ای است که کاربر احتمالا در این تست از آن استفاده کرده است. این مقدار با درخواست DNS مستقل به آدرس whoami.akamai.net محاسبه می شود. به صورت زیر:\n   test_keys #  دیتای اصلی هر تست، در بخش test_keys قرار دارد:\n   network_events #  بخش network_events شامل رویداد های ارتباطی مابین کلاینت و سرور است. ساده تر از چیزی که با capture کردن packet ها به دست می آوریم. برای اینکه ببینیم که مسدود شدن بعد از Client hello بوده است و یا بعد از TLS handshake.\n   tls_handshakes #  بخش tls_handshakes شامل certificate هایی است که در هر بار request از سرور دریافت می شود.\n   در صورت حمله ی MITM این دیتا بسیار مفید خواهد بود. و در صورت خطا در زمان TLS handshake، توضیح آن بیان می شود:\n   queries #  بخش queries شامل درخواست های DNS و جواب های دریافت شده می شود:\n   dns_consistency #  بخش dns_consistency مربوط می شود به یکسان بودن و یا نبودن جواب DNS در تست انجام شده در سرور OONI و در این شبکه ی فعلی در همان لحظه.\ncontrol #  بخش control مربوط می شود به تست های انجام شده در سرور OONI که همزمان صورت می گیرد.\n   tcp_connect #  بخش tcp_connect مربوط می شود به تست TCP handshake تمام IP هایی که از درخواست DNS به دست آمد.\n   requests #  بخش requests مربوط می شود به درخواست ها و جواب هایی که در سطح HTTP انجام می شوند.\n   در اینجا درخواست انجام نشده.    در اینجا جوابی با iframe از صفحه ی سیستم سانسور جمهوری اسلامی بازگردانده شده.\nبیشتر #  بخش های دیگر نیز نسبت به HTTP و یا HTTPS بودن ارتباط متفاوت است.\nدر اینجا نشان می دهد که تبادل HTTP در HTTPS به درستی انجام نشده است:\n   و یا مقادیر دو تست درون و بیرون شبکه در ارتباط HTTP یکسان نیست:\n   تشخیص تحریم #  یکی از سوال های مهم که در هر بار عدم دسترسی به سرویس ای یک ایرانی از خودش می پرسد این است که «آیا این سایت فیلتر شده و یا تحریم؟» برای پاسخ به این سوال نیز می توان از OONI کمک گرفت. چرا که علاوه بر اینکه موارد زیادی را آنالیز می کند، همزمان هم در شبکه ی فعلی و هم از طریق سرور backend، اتصال به آدرس مورد نظر را بررسی و مقایسه می کند. اگر آدرس وارد شده HTTPS باشد، به دلیل اینکه توسط شخص ناشناس قابل دستکاری نیست، نتیجه قابل اعتمادتر خواهد بود. در ادامه یک آدرسی را که به دلیل استفاده از کلاد گوگل در ایران قابل استفاده نیست را به صورت نمونه بررسی می کنیم.\n   در نتیجه ی آنالیز می بینیم که به رنگ سبز است و این یعنی مشکلی در ارتباط وجود ندارد.\n   در بخش Failure نیز می بینیم که تمام آنها null هستند و این یعنی هیچ دستکاری ای در شبکه انجام نشده است.\n   در بخش داده ها و در زیرمجموعه ی control می بنیم که مقدار عنوان درست است و همینطور کد دریافتی برابر با 200 است. که این یعنی سرور سایت به شبکه ای دیگر در خارج از کشور به درستی جواب می دهد.\n   اما در بخش requests کد دریافتی و همچنین response دارای مقدار متفاوتی است.\nکد 403 و گاهی کد 404 اگر در این شرایط گفته شده (ارتباط HTTPS و متفاوت با نتیجه ی خارج از کشور) باشد، به معنای تحریم است.\nهمچنین در انتهای بخش test_keys مقایسه هایی صورت میگیرد که نتیجه ی کلی از تمام موارد گفته شده در بالا را نشان می دهد.\n   ذکر این نکته مهم است که طی یک سال اخیر مورد ای از تحریم مشاهده نشده که بدون نمایش خطای 403 و یا 404 در ارتباط HTTPS از درخواست ها به دلیل تحریم جلوگیری کنند. در نتیجه اگر نتیجه غیر از سبز بود، احتمالا سایت به طریقی در شبکه ی شما سانسور شده است.\nتنظیم داخلی فیلترشکن فقط برای ارتباط با backend #  به دلیل سانسور های دسته ای سرویس ها در ایران و بدون در نظر گرفتن عواقب آن و زیر پا گذاشتن حق‌الناس توسط حکومتی که مدعی آن است، ارتباط با سرور OONI در موبایل، به دلیلی که در بخش «شناسایی مسدود شدن از طریق fingerprint» توضیح داده شد، امکان پذیر نیست.\n   برای حل این مشکل، تیم OONI دو تغییر مهم ایجاد کردند: تغییر TLS fingerprint برای تقلید fingerprint مرورگر اضافه کردن بخش Proxy برای ارتباط با backend\nبرای فعال کردن proxy، به بخش تنظیمات رفته و OONI backend Proxy را انتخاب می کنیم:\n   در این بخش (در زمان نوشتن این مقاله) سه گزینه ی اصلی داریم: از هیچ proxy ای استفاده نشود از Psiphon استفاده شود از یک Proxy شخصی استفاده شود. (در حال حاضر فقط SOCKS5)\n   تنظیماتی که در تصویر می بینید (127.0.0.1:9050) متعلق به SOCKS5 ای است که توسط Orbot ایجاد می شود.\n   توجه داشته باشید که برای استفاده از OONI، نباید حالت VPN فعال باشد. اگر از Tor Browser استفاده می کنید، port آن برای SOCKS5 برابر با 9150 است.\nبعد از فعال کردن یکی از این گزینه ها. ارتباط با backend توسط آن proxy صورت می گیرد اما تست ها از طریق خود شبکه:\n   در تصویر می بینید که ابتدا به Psiphon متصل می شود.\n   اما تست ها از طریق شبکه ی کاربر انجام می شود.\n"},{"id":2,"href":"/fa/docs/measure-internet-censorship/DNS/","title":"بررسی سانسور اینترنت در ارتباط DNS","section":"مقدمه ی بررسی سانسور اینترنت","content":"بررسی سانسور اینترنت در ارتباط DNS #  اولین قدم برای دسترسی به اینترنت DNS است. وقتی شما آدرس نام دامنه را وارد می کنید، این نام باید به IP تبدیل شود تا دستگاه شما بتواند با سرور آن ارتباط برقرار کند. این کار توسط DNS انجام می شود. یکی از بهترین ابزار ها برای بررسی سانسور در DNS نرم افزار dig است. که علاوه بر لینوکس و Mac OS، در ویندوز هم قابل استفاده است. در حال حاضر روش های مختلفی برای انجام تست DNS داریم. چند مورد پر استفاده و مهم از آنها عبارت اند از:\n DNS over UDP DNS over TCP DNS over HTTPS DNS over TLS  DNS over UDP #  DNS over UDP روش پیشفرض اکثر سیستم عامل ها است. این روش توسط شخص ناشناس قابل مشاهده و یا دستکاری است. اکثر سیستم های سانسور و بدافزار های شبکه، از این روش برای تغییر مسیر کاربران استفاده می کنند. در ایران معمولا جواب درخواست های DNS سایت های فیلتر شده به یکی از سه آدرس 10.10.34.34، 10.10.34.35، 10.10.34.36، تغییر می کنند.\nدرخواست DNS از طریق مقدار پیشفرض DNS تنظیم شده در سیستم عامل:\n$ dig twitter.com \n  درخواست DNS با تنظیم دستی سرور DNS:\n$ dig twitter.com @8.8.8.8 \n  نمایش این packet ها در نرم افزار wireshark:\n  انجام این درخواست با ابزار پیشفرض سیستم عامل ویندوز:\n\u0026gt; nslookup twitter.com \n  و تنظیم آدرس سرور DNS اختصاصی:\n\u0026gt;nslookup twitter.com 1.1.1.1 \n  البته ممکن است همیشه چنین جوابی دریافت نکنید و درخواست های شما با جوابی همراه نباشند. در این شرایط درخواست ها وارد سیاه چاله می شوند.\n$ dig youtube.com \n  در Wireshark هم می بینید که جوابی دریافت نشده:\n  و همینطور در سیستم عامل و سرور DNS متفاوت:\n\u0026gt; nslookup youtube.com 1.1.1.1 \n  نکته ی مهم این است که در ایران فرقی نمی کند که از چه سرویس ای درخواست می کنید. حتی فرقی نمی کند که آیا IP ای که درخواست می شود، واقعا سرویس DNS است یا خیر. و یا حتی فعال است یا خیر. به عنوان مثال، اگر از 1.1.1.1 استفاده می کنید و درخواستی دارید که فیلتر شده باشد، درخواست شما توسط سیستم سانسور ضبط می شود و به 1.1.1.1 نمی رسد و جوابی مثل 10.10.34.34 برای شما ارسال می کند.\nبرای امتحان، می توانید در سرور شخصی خود این دستور را اجرا کنید تا packet های ورودی مرتبط، به شما نشان داده شوند:\n  مقدار آخر برابر با IP ی دستگاه ایران شما است و eth0 نام interface اصلی شما که می توانید با اجرای دستور زیر آن را به دست بیاورید:\n$ ip link show\n در ادامه ی بحث اصلی، اگر درخواست را به صورت زیر وارد کنید:\n  که مقدار آخر برابر با IP ی سرور خارج شما است. چنین packet هایی در سرور دریافت می کنید:\n  اما اگر یک سایتی که فیلتر شده را به جای آدرس google.com وارد کنید، packet ای در سمت سرور دریافت نمی شود و سیستم سانسور از سمت سرور ای که هیچ سرویس DNS در آن فعال نیست. IP ای از 10.10.34.3x را بر می گرداند:\n  سیستم سانسور چین، معمولا یک IP ی random در جواب DNS سایت های سانسور شده برای کاربر ارسال می کند. از آنجایی که IP با آدرس درخواستی برابر نخواهد بود، نتیجتا باعث خطا می شود. یا سیستم سانسور بعضی از کشور ها 127.0.0.1 و یا 192.168.0.1 را در جواب سایت های سانسور شده ارسال می کنند. همچنین ممکن است بعضی از کشور ها از یک IP در دسترس اینترنت (IP public) برای سانسور استفاده کنند. مانند IP ای که ایران استفاده می کرده تا افرادی که سهوا و یا عمدا به سرویس های ممنوعه، همانند سایت قمار و شرطبندی، تلگرام، سرویس کوتاه کننده ی لینک و غیره رجوع می کردند، تحت پیگرد قانونی قرار دهد.\n DNS over TCP #  DNS over TCP هم از پورت مشابه DNS over UDP استفاده می کند و مشترکا Do53 معرفی می شوند. هر دوی اینها توسط شخص ناشناس قابل مشاهده است اما در ایران DNS over TCP به سمت سرور های خارجی دستکاری نمی شود. توجه داشته باشید که اگر از یک DNS داخلی استفاده کنید، در اکثر آنها فرقی نمی کند که شما از چه پروتکل ای استفاده می کنید و جواب IP ی صفحه ی سانسور برای شما برگردانده می شود.\n$ dig youtube.com +tcp \n  استفاده از سرور خارجی:\n$ dig youtube.com +tcp @8.8.8.8 \n  در ویندوز nslookup قابلیت DNS over TCP ندارد. خاطر همین ما از dig استفاده می کنیم:\n\u0026gt; .\\dig youtube.com +tcp \u0026quot;@8.8.8.8\u0026quot; \n  گاهی مشاهده شده که بعضی درخواست هاتوسط سیستم سانسور وارد سیاهچاله می شوند.\n$ dig +tcp youtube.com @1.1.1.1 ;; Connection to 1.1.1.1#53(1.1.1.1) for youtube.com failed: timed out. ;; Connection to 1.1.1.1#53(1.1.1.1) for youtube.com failed: timed out. ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.11.5-P4-5.1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; +tcp youtube.com @1.1.1.1 ;; global options: +cmd ;; connection timed out; no servers could be reached ;; Connection to 1.1.1.1#53(1.1.1.1) for youtube.com failed: timed out.  DNS over HTTPS #  DNS over HTTPS یا به اختصار DoH، معروف ترین نوع DNS رمزنگاری شده است که اکنون استفاده می شود. پورت پیشفرض اش معمولا 443 است و در هر نرم افزاری که می تواند درخواست HTTPS انجام دهد قابل پیاده سازی است.\nدر شرایط عادی شخص ناشناس فقط می تواند IP و یا نام دامنه (در صورت وجود) همین سرویس را مشاهده کند. اینکه درخواست و یا جواب چیست از دید شخص ناشناس پوشیده است. توضیح اینکه در شرایط عادی، برای آدرس سرور DoH، از نام دامنه استفاده می شود. به عنوان مثال https://dns.google/dns-query . قبل از اینکه درخواست DNS اصلی شما از سرور درخواست شود، باید آدرس dns.google به IP تبدیل شود. برای این کار از DNS پیشفرض سیستم عامل استفاده می شود که معمولا DNS over UDP است. بعد از انجام TCP handshake و بعد TLS handshake، درخواست کاربر که به صورت HTTP است رمزنگاری و ارسال و جواب دریافت می شود.\nدر حال حاضر سیستم عامل های Windows، MacOS، iOS و همچنین مرورگر های بر پایه ی Chromium مانند Chrome، Edge، Opera، Brave و غیره و مرورگر Mozilla FireFox از DoH پشتیبانی می کنند. در کروم، روش پیشفرض به این صورت است که اگر DNS ای که کاربر تنظیم کرده است، قابل ارتقا به DoH را نیز داشته باشد، از آن استفاده می کند، مگر اینکه کاربر روش دیگری را انتخاب کرده باشد. در فایرفاکس در صورت فعال کردن DoH، روش پیشفرض به این صورت است که اگر درخواست DoH با شکست مواجه شد، از DNS پیشفرض سیستم استفاده کند. که یعنی اگر DNS پیشفرض سیستم عامل کاربر از نوع DNS over UDP باشد، در این شرایط شخص ناشناس می تواند درخواست و جواب را مشاهده و یا دستکاری کند. امنیت ارتباط در این روش به اعتبار root CA سیستم عامل و یا برنامه ی مورد استفاده ی شما بستگی دارد.\nبرای انجام تست، می توانید از curl برای DoH استفاده کنید و جواب json دریافت کنید.\nدرخواست ساده از گوگل:\n$ curl -s \u0026#34;https://dns.google.com/resolve?name=www.who.int\u0026amp;type=A\u0026#34; {\u0026#34;Status\u0026#34;: 0,\u0026#34;TC\u0026#34;: false,\u0026#34;RD\u0026#34;: true,\u0026#34;RA\u0026#34;: true,\u0026#34;AD\u0026#34;: false,\u0026#34;CD\u0026#34;: false,\u0026#34;Question\u0026#34;:[ {\u0026#34;name\u0026#34;: \u0026#34;www.who.int.\u0026#34;,\u0026#34;type\u0026#34;: 1}],\u0026#34;Answer\u0026#34;:[ {\u0026#34;name\u0026#34;: \u0026#34;www.who.int.\u0026#34;,\u0026#34;type\u0026#34;: 5,\u0026#34;TTL\u0026#34;: 366,\u0026#34;data\u0026#34;: \u0026#34;www.who.int.cdn.cloudflare.net.\u0026#34;},{\u0026#34;name\u0026#34;: \u0026#34;www.who.int.cdn.cloudflare.net.\u0026#34;,\u0026#34;type\u0026#34;: 1,\u0026#34;TTL\u0026#34;: 216,\u0026#34;data\u0026#34;: \u0026#34;104.17.113.188\u0026#34;},{\u0026#34;name\u0026#34;: \u0026#34;www.w ho.int.cdn.cloudflare.net.\u0026#34;,\u0026#34;type\u0026#34;: 1,\u0026#34;TTL\u0026#34;: 216,\u0026#34;data\u0026#34;: \u0026#34;104.17.112.188\u0026#34;}]}  از Cloudflare :\n$ curl -H \u0026#39;accept: application/dns-json\u0026#39; \u0026#39;https://1.1.1.1/dns-query?name=www.who.int\u0026amp;type=A\u0026#39; {\u0026#34;Status\u0026#34;:0,\u0026#34;TC\u0026#34;:false,\u0026#34;RD\u0026#34;:true,\u0026#34;RA\u0026#34;:true,\u0026#34;AD\u0026#34;:false,\u0026#34;CD\u0026#34;:false,\u0026#34;Question\u0026#34;:[{\u0026#34;name\u0026#34;:\u0026#34;www.who.int\u0026#34;,\u0026#34;type\u0026#34;:1}],\u0026#34;Answer\u0026#34;:[{\u0026#34;name\u0026#34;:\u0026#34;www.who.int\u0026#34;,\u0026#34;type\u0026#34;:5,\u0026#34;TTL\u0026#34;:839,\u0026#34; data\u0026#34;:\u0026#34;www.who.int.cdn.cloudflare.net.\u0026#34;},{\u0026#34;name\u0026#34;:\u0026#34;www.who.int.cdn.cloudflare.net\u0026#34;,\u0026#34;type\u0026#34;:1,\u0026#34;TTL\u0026#34;:239,\u0026#34;data\u0026#34;:\u0026#34;104.17.112.188\u0026#34;},{\u0026#34;name\u0026#34;:\u0026#34;www.who.int.cdn.cloudflare. net\u0026#34;,\u0026#34;type\u0026#34;:1,\u0026#34;TTL\u0026#34;:239,\u0026#34;data\u0026#34;:\u0026#34;104.17.113.188\u0026#34;}]}  ( -H یک header به درخواست HTTP اضافه می کند.)\nدر بعضی نسخه های لینوکس می توان از دستور doh استفاده کرد:\n$ doh twitter.com   و یا اگر می خواهید در درخواست curl از DoH استفاده کنید:\n$ curl --doh-url https://doh.powerdns.org/ https://www.google.com/.well-known/security.txt Contact: https://g.co/vulnz Contact: mailto:security@google.com Encryption: https://services.google.com/corporate/publickey.txt Acknowledgements: https://bughunter.withgoogle.com/ Policy: https://g.co/vrp Hiring: https://g.co/SecurityPrivacyEngJobs # Flag: BountyCon{075e1e5eef2bc8d49bfe4a27cd17f0bf4b2b85cf}  در بعضی ISP ها ممکن است با خطا مواجه شوید که به دلیل شیوه ای از سانسور اینترنت است که در بخش مربوط به بررسی سانسور در HTTPS توضیح داده شد.\nDNS over TLS #  DNS over TLS یا به اختصار DoT، روشی رمزنگاری شده از DNS over TCP است. نوع ارتباط در ALPN از نوع dot است و طبق استاندارد، بر روی پورت 853 باید سرویس دهی شود. شناسایی و مسدود کردن این نوع توسط سیستم های سانسور بسیار راحت تر از DoH است. اما محتوای درخواست ها و جواب ها توسط شخص ناشناس قابل مشاهده نیست. این نوع نیز همانند DoH در صورت استفاده از نام دامنه، متکی به سرویس DNS over UDP پیشفرض است.\nدر حال حاضر سیستم عامل های Android، Linux، iOS و MacOS از این نوع DNS پشتیبانی می کنند.\nدر آخرین نسخه از dig (نسخه ی تست شده:‌ 9.17.11 ) این امکان فراهم شد تا بتوان درخواست DoT داشت. به صورت استفاده از +tls:\n\u0026gt; .\\dig telegram.org +tls \u0026quot;@dns9.quad9.net\u0026quot; \n  البته این قابلیت در dig هنوز به صورت کامل استاندارد ها را رعایت نکرده و به صورت رسمی در لحظه ی نوشتن این مقاله، این قابلیت رونمایی نشده.\nتوجه داشته باشید که DNS نقش حیاتی در امنیت ارتباطات شما دارد. اگر از DNS نامعتبر استفاده کنید و یا اینکه شخص ناشناس بتواند محتوای ارسالی و یا دریافتی آن را دستکاری کند، امنیت شما به خطر می افتد. به این دلیل همیشه سعی کنید از DNS های معتبر و با قابلیت رمزنگاری محتوا استفاده کنید. در ارتباطات رمزنگاری شده، یا شما مشکلی نخواهید داشت، و یا ارتباط با آن سرور تماما مسدود می شود.\n"}]